<h1>Posts</h1>

<% @posts.each do |post| %>
  <div class="post">
    <h2><%= post.title %></h2>
    <p><%= post.body %></p>
    <p>Posted by: <%= post.user.email %></p>
    <h3>Comments:</h3>
    <ul>
      <% post.comments.each do |comment| %>
        <li>
          <strong><%= comment.user.email %>:</strong> <%= comment.body %>
        </li>
      <% end %>
    </ul>

    <h3>Add a comment:</h3>
    <%= form_with(model: [post, post.comments.build], local: true) do |form| %>
      <div class="field">
        <%= form.label :body %>
        <%= form.text_area :body %>
      </div>
      <div class="actions">
        <%= form.submit "Add Comment" %>
      </div>
    <% end %>
  </div>
  <hr>
<% end %>
